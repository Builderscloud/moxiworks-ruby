require 'spec_helper'
require 'vcr'

describe MoxiworksPlatform::Gallery do
  accessors = [
      :listing_id,
      :gallery_images,
      :list_office_aor
  ]



  describe :attr_accessors do
    before :each do
      @gallery = MoxiworksPlatform::Gallery.new
    end

    context :accessors do
      accessors.each do |attr_accessor|
        it "should return for gallery attribute #{attr_accessor}" do
          expect(@gallery.send("#{attr_accessor.to_s}")).to eq nil
        end

        it "should allow setting for gallery attribute #{attr_accessor}" do
          @gallery.send("#{attr_accessor.to_s}=", '1234')
          expect("#{@gallery.send("#{attr_accessor.to_s}").to_i}").to eq '1234'
        end
      end
    end
    it 'should raise exception when trying to set an attribute that is not defined' do
      expect {@gallery.foobar = 'broked' }.to raise_exception(NoMethodError)
    end
  end

  describe :class_methods do
    let!(:platform_id){'abc123'}
    let!(:platform_secret) { 'secret' }
    let!(:moxi_works_agent_id) { '1234abcd' }
    let!(:moxi_works_company_id) {'abc123'}

    context :find do
      context :credentials_required do
        it 'should raise a MoxiworksPlatform::AuthorizationError if find is called without authorization' do
          VCR.use_cassette('gallery/find/success', record: :none) do
            expect {MoxiworksPlatform::Gallery.find(
                moxi_works_agent_id: moxi_works_agent_id,
                moxi_works_company_id: moxi_works_company_id) }.to raise_exception(MoxiworksPlatform::Exception::AuthorizationError)
          end
        end
      end

      context :test_response_data_handling do
        before :each do
          MoxiworksPlatform::Credentials.new(platform_id, platform_secret)
        end

        after :each do
          MoxiworksPlatform::Credentials.platform_identifier = nil
          MoxiworksPlatform::Credentials.platform_secret = nil
          MoxiworksPlatform::Credentials.instance = nil
        end

        context :not_found do
          it 'should return a nil Object when find can not find anything' do
            VCR.use_cassette('gallery/find/nothing', record: :none) do
              out = MoxiworksPlatform::Gallery.find(moxi_works_agent_id: moxi_works_agent_id,
               moxi_works_company_id: moxi_works_company_id)
              expect(out['galleries']).to be_a(Array)
              expect(out['galleries'][0]).to be_nil
            end
          end
        end

        context :full_response do
          full_response = MoxiworksPlatform::Gallery.underscore_attribute_names(JSON.parse('{"galleries":[{"ListingID":"233606","ListOfficeAOR":"PSM","ListingImages":[{"FullURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_full.jpg","GalleryURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_gallery.jpg","RawURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_raw.jpg","SmallURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_small.jpg","ThumbURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_thumb.jpg","EmbededHTMLContent":"","Title":"","IsMainListingImage":true,"Caption":"","Description":"","Width":3456,"Height":2303,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/255b5b9adf0e0a783a179a49a15a17942988f3c6/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/255b5b9adf0e0a783a179a49a15a17942988f3c6/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/255b5b9adf0e0a783a179a49a15a17942988f3c6/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/255b5b9adf0e0a783a179a49a15a17942988f3c6/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/255b5b9adf0e0a783a179a49a15a17942988f3c6/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"LIVING / DINING ROOM","IsMainListingImage":false,"Caption":"LIVING / DINING ROOM","Description":"","Width":3456,"Height":2303,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/708fd5f7171ce48bb21e9f7fa91ad64260fa6945/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/708fd5f7171ce48bb21e9f7fa91ad64260fa6945/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/708fd5f7171ce48bb21e9f7fa91ad64260fa6945/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/708fd5f7171ce48bb21e9f7fa91ad64260fa6945/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/708fd5f7171ce48bb21e9f7fa91ad64260fa6945/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"LIVING / DINING ROOM","IsMainListingImage":false,"Caption":"LIVING / DINING ROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/ece4361d4649ad6a34659bd832755f1b5791e7e4/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/ece4361d4649ad6a34659bd832755f1b5791e7e4/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/ece4361d4649ad6a34659bd832755f1b5791e7e4/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/ece4361d4649ad6a34659bd832755f1b5791e7e4/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/ece4361d4649ad6a34659bd832755f1b5791e7e4/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"LIVING / DINING ROOM","IsMainListingImage":false,"Caption":"LIVING / DINING ROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/8861cfefe7b15f5952edc8090c3ca5c78690fd40/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/8861cfefe7b15f5952edc8090c3ca5c78690fd40/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/8861cfefe7b15f5952edc8090c3ca5c78690fd40/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/8861cfefe7b15f5952edc8090c3ca5c78690fd40/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/8861cfefe7b15f5952edc8090c3ca5c78690fd40/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"LIVING / DINING ROOM","IsMainListingImage":false,"Caption":"LIVING / DINING ROOM","Description":"","Width":3456,"Height":2303,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/01f047e54650afd7f9da3070b186fb2492f37b4f/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/01f047e54650afd7f9da3070b186fb2492f37b4f/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/01f047e54650afd7f9da3070b186fb2492f37b4f/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/01f047e54650afd7f9da3070b186fb2492f37b4f/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/01f047e54650afd7f9da3070b186fb2492f37b4f/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"KITCHEN","IsMainListingImage":false,"Caption":"KITCHEN","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/27d5a076780a07837f44d9068ec9367a58907eb8/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/27d5a076780a07837f44d9068ec9367a58907eb8/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/27d5a076780a07837f44d9068ec9367a58907eb8/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/27d5a076780a07837f44d9068ec9367a58907eb8/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/27d5a076780a07837f44d9068ec9367a58907eb8/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"KITCHEN","IsMainListingImage":false,"Caption":"KITCHEN","Description":"","Width":3456,"Height":2302,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/de3fc9374af1b77bb7c0e43c89bb06d74084b77f/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/de3fc9374af1b77bb7c0e43c89bb06d74084b77f/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/de3fc9374af1b77bb7c0e43c89bb06d74084b77f/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/de3fc9374af1b77bb7c0e43c89bb06d74084b77f/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/de3fc9374af1b77bb7c0e43c89bb06d74084b77f/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"MASTER BEDROOM / BATH","IsMainListingImage":false,"Caption":"MASTER BEDROOM / BATH","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/3f5b647e9884bb3a188fd21f7d6d257ad0767eeb/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/3f5b647e9884bb3a188fd21f7d6d257ad0767eeb/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/3f5b647e9884bb3a188fd21f7d6d257ad0767eeb/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/3f5b647e9884bb3a188fd21f7d6d257ad0767eeb/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/3f5b647e9884bb3a188fd21f7d6d257ad0767eeb/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"MASTER BEDROOM / BATH","IsMainListingImage":false,"Caption":"MASTER BEDROOM / BATH","Description":"","Width":3456,"Height":2303,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/383cdfaa1f2c170e0ab0f4c1f3d2f803081be630/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/383cdfaa1f2c170e0ab0f4c1f3d2f803081be630/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/383cdfaa1f2c170e0ab0f4c1f3d2f803081be630/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/383cdfaa1f2c170e0ab0f4c1f3d2f803081be630/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/383cdfaa1f2c170e0ab0f4c1f3d2f803081be630/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"ADDITIONAL BEDROOM","IsMainListingImage":false,"Caption":"ADDITIONAL BEDROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/f63d6562209c929ae318352a81d9afb49c4dab2e/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/f63d6562209c929ae318352a81d9afb49c4dab2e/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/f63d6562209c929ae318352a81d9afb49c4dab2e/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/f63d6562209c929ae318352a81d9afb49c4dab2e/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/f63d6562209c929ae318352a81d9afb49c4dab2e/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"MAIN BATHROOM","IsMainListingImage":false,"Caption":"MAIN BATHROOM","Description":"","Width":3456,"Height":2238,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_full.jpg","GalleryURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_gallery.jpg","RawURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_raw.jpg","SmallURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_small.jpg","ThumbURL":"http://foo.bar/img-np/i/1b535d083f60f70c07ce7a49f8f994bed705d4fa/0_3_thumb.jpg","EmbededHTMLContent":"","Title":"FRONT OF HOME","IsMainListingImage":false,"Caption":"FRONT OF HOME","Description":"","Width":3456,"Height":2303,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/6c89d89a3f9c6f3c9be4f1dcb4f26173311e137c/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/6c89d89a3f9c6f3c9be4f1dcb4f26173311e137c/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/6c89d89a3f9c6f3c9be4f1dcb4f26173311e137c/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/6c89d89a3f9c6f3c9be4f1dcb4f26173311e137c/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/6c89d89a3f9c6f3c9be4f1dcb4f26173311e137c/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"BACK DECK","IsMainListingImage":false,"Caption":"BACK DECK","Description":"","Width":3455,"Height":2303,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/edcc09fb48a8d6509716a92b5519fc4f6c1996ba/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/edcc09fb48a8d6509716a92b5519fc4f6c1996ba/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/edcc09fb48a8d6509716a92b5519fc4f6c1996ba/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/edcc09fb48a8d6509716a92b5519fc4f6c1996ba/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/edcc09fb48a8d6509716a92b5519fc4f6c1996ba/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"OUTDOOR POOL","IsMainListingImage":false,"Caption":"OUTDOOR POOL","Description":"","Width":3456,"Height":2300,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/7f7b6bb79570a250a9878d13fdb19d107b9cbb63/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/7f7b6bb79570a250a9878d13fdb19d107b9cbb63/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/7f7b6bb79570a250a9878d13fdb19d107b9cbb63/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/7f7b6bb79570a250a9878d13fdb19d107b9cbb63/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/7f7b6bb79570a250a9878d13fdb19d107b9cbb63/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"OUTDOOR POOL","IsMainListingImage":false,"Caption":"OUTDOOR POOL","Description":"","Width":3449,"Height":2302,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/14bb9cb2a5cc818dec46e0ccd620c6babfd30f47/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/14bb9cb2a5cc818dec46e0ccd620c6babfd30f47/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/14bb9cb2a5cc818dec46e0ccd620c6babfd30f47/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/14bb9cb2a5cc818dec46e0ccd620c6babfd30f47/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/14bb9cb2a5cc818dec46e0ccd620c6babfd30f47/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"CLUBHOUSE","IsMainListingImage":false,"Caption":"CLUBHOUSE","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/2aed7555c40265dd50537985293dcd57f48014f1/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/2aed7555c40265dd50537985293dcd57f48014f1/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/2aed7555c40265dd50537985293dcd57f48014f1/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/2aed7555c40265dd50537985293dcd57f48014f1/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/2aed7555c40265dd50537985293dcd57f48014f1/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"TENNIS COURT","IsMainListingImage":false,"Caption":"TENNIS COURT","Description":"","Width":3455,"Height":2303,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/f671d511f00dbcb8c683a331c9e253a92a8c357e/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/f671d511f00dbcb8c683a331c9e253a92a8c357e/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/f671d511f00dbcb8c683a331c9e253a92a8c357e/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/f671d511f00dbcb8c683a331c9e253a92a8c357e/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/f671d511f00dbcb8c683a331c9e253a92a8c357e/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"COMPLEX GROUNDS","IsMainListingImage":false,"Caption":"COMPLEX GROUNDS","Description":"","Width":3455,"Height":2302,"MimeType":"image/jpeg"}]},{"ListingID":"240727","ListOfficeAOR":"PSM","ListingImages":[{"FullURL":"http://foo.bar/img-np/i/b453f92f4573a86d9caa5c61f812c3554020f27a/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/b453f92f4573a86d9caa5c61f812c3554020f27a/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/b453f92f4573a86d9caa5c61f812c3554020f27a/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/b453f92f4573a86d9caa5c61f812c3554020f27a/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/b453f92f4573a86d9caa5c61f812c3554020f27a/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"","IsMainListingImage":true,"Caption":"","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/c2bbac3bb5a2c727afa86dd0287d721e076c468f/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/c2bbac3bb5a2c727afa86dd0287d721e076c468f/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/c2bbac3bb5a2c727afa86dd0287d721e076c468f/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/c2bbac3bb5a2c727afa86dd0287d721e076c468f/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/c2bbac3bb5a2c727afa86dd0287d721e076c468f/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"LIVING ROOM","IsMainListingImage":false,"Caption":"LIVING ROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/494231fbb02aefbad4cb5c871fdcaff113a2489c/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/494231fbb02aefbad4cb5c871fdcaff113a2489c/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/494231fbb02aefbad4cb5c871fdcaff113a2489c/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/494231fbb02aefbad4cb5c871fdcaff113a2489c/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/494231fbb02aefbad4cb5c871fdcaff113a2489c/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"LIVING ROOM","IsMainListingImage":false,"Caption":"LIVING ROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/23099f8238634c9e20745a830b291c405a4a828a/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/23099f8238634c9e20745a830b291c405a4a828a/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/23099f8238634c9e20745a830b291c405a4a828a/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/23099f8238634c9e20745a830b291c405a4a828a/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/23099f8238634c9e20745a830b291c405a4a828a/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"DINING ROOM","IsMainListingImage":false,"Caption":"DINING ROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/7f403e2bf4e4a2e8fc2fd5a5b66ce9924ce7147b/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/7f403e2bf4e4a2e8fc2fd5a5b66ce9924ce7147b/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/7f403e2bf4e4a2e8fc2fd5a5b66ce9924ce7147b/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/7f403e2bf4e4a2e8fc2fd5a5b66ce9924ce7147b/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/7f403e2bf4e4a2e8fc2fd5a5b66ce9924ce7147b/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"DINING ROOM","IsMainListingImage":false,"Caption":"DINING ROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/2bcdb403f2b5e7dbf99c644cc9d7dfd6d6ee4a40/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/2bcdb403f2b5e7dbf99c644cc9d7dfd6d6ee4a40/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/2bcdb403f2b5e7dbf99c644cc9d7dfd6d6ee4a40/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/2bcdb403f2b5e7dbf99c644cc9d7dfd6d6ee4a40/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/2bcdb403f2b5e7dbf99c644cc9d7dfd6d6ee4a40/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"KITCHEN","IsMainListingImage":false,"Caption":"KITCHEN","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/820d1b832950bde5e87474d2c9c7bb159f2528e4/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/820d1b832950bde5e87474d2c9c7bb159f2528e4/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/820d1b832950bde5e87474d2c9c7bb159f2528e4/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/820d1b832950bde5e87474d2c9c7bb159f2528e4/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/820d1b832950bde5e87474d2c9c7bb159f2528e4/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"DOWNSTAIRS BEDROOM","IsMainListingImage":false,"Caption":"DOWNSTAIRS BEDROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/3cce391100201a6d34e4534714074cd4c61f9786/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/3cce391100201a6d34e4534714074cd4c61f9786/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/3cce391100201a6d34e4534714074cd4c61f9786/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/3cce391100201a6d34e4534714074cd4c61f9786/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/3cce391100201a6d34e4534714074cd4c61f9786/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"MAIN FLOOR BATHROOM","IsMainListingImage":false,"Caption":"MAIN FLOOR BATHROOM","Description":"","Width":800,"Height":600,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/ee71c284869ad0d9d10b813fce63885cb38e21e7/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/ee71c284869ad0d9d10b813fce63885cb38e21e7/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/ee71c284869ad0d9d10b813fce63885cb38e21e7/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/ee71c284869ad0d9d10b813fce63885cb38e21e7/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/ee71c284869ad0d9d10b813fce63885cb38e21e7/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"MASTER BEDROOM / BATHROOM","IsMainListingImage":false,"Caption":"MASTER BEDROOM / BATHROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/79a7ca2c0eb51784c92fe23f8c8cfc4499feb47b/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/79a7ca2c0eb51784c92fe23f8c8cfc4499feb47b/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/79a7ca2c0eb51784c92fe23f8c8cfc4499feb47b/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/79a7ca2c0eb51784c92fe23f8c8cfc4499feb47b/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/79a7ca2c0eb51784c92fe23f8c8cfc4499feb47b/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"MASTER BEDROOM / BATHROOM","IsMainListingImage":false,"Caption":"MASTER BEDROOM / BATHROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/978836ddd38f9eda7f9858fc111b89767004e613/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/978836ddd38f9eda7f9858fc111b89767004e613/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/978836ddd38f9eda7f9858fc111b89767004e613/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/978836ddd38f9eda7f9858fc111b89767004e613/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/978836ddd38f9eda7f9858fc111b89767004e613/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"MASTER BEDROOM / BATHROOM","IsMainListingImage":false,"Caption":"MASTER BEDROOM / BATHROOM","Description":"","Width":2304,"Height":3456,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/0cf4253e0e096cac4c5b1cdc3fdc65fcecb2a589/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/0cf4253e0e096cac4c5b1cdc3fdc65fcecb2a589/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/0cf4253e0e096cac4c5b1cdc3fdc65fcecb2a589/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/0cf4253e0e096cac4c5b1cdc3fdc65fcecb2a589/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/0cf4253e0e096cac4c5b1cdc3fdc65fcecb2a589/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"DEN / SITTING ROOM","IsMainListingImage":false,"Caption":"DEN / SITTING ROOM","Description":"","Width":640,"Height":480,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/022c4e13d60586225d4268656bdf648096194f82/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/022c4e13d60586225d4268656bdf648096194f82/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/022c4e13d60586225d4268656bdf648096194f82/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/022c4e13d60586225d4268656bdf648096194f82/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/022c4e13d60586225d4268656bdf648096194f82/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"UPSTAIRS BEDROOM","IsMainListingImage":false,"Caption":"UPSTAIRS BEDROOM","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/c438ae9a4e7fa5613bb7e5382819aace7eb4bcf0/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/c438ae9a4e7fa5613bb7e5382819aace7eb4bcf0/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/c438ae9a4e7fa5613bb7e5382819aace7eb4bcf0/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/c438ae9a4e7fa5613bb7e5382819aace7eb4bcf0/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/c438ae9a4e7fa5613bb7e5382819aace7eb4bcf0/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"FRONT OF HOME","IsMainListingImage":false,"Caption":"FRONT OF HOME","Description":"","Width":800,"Height":600,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/e22de53cf95e10314b402e0708e8f20b4767d233/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/e22de53cf95e10314b402e0708e8f20b4767d233/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/e22de53cf95e10314b402e0708e8f20b4767d233/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/e22de53cf95e10314b402e0708e8f20b4767d233/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/e22de53cf95e10314b402e0708e8f20b4767d233/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"FRONT OF HOME","IsMainListingImage":false,"Caption":"FRONT OF HOME","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/f3713b900faf27b4563034c5539b329e94ec385b/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/f3713b900faf27b4563034c5539b329e94ec385b/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/f3713b900faf27b4563034c5539b329e94ec385b/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/f3713b900faf27b4563034c5539b329e94ec385b/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/f3713b900faf27b4563034c5539b329e94ec385b/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"DECK","IsMainListingImage":false,"Caption":"DECK","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/c48b03ca85dc9ac5a0b99274a5c45f111f2eec1c/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/c48b03ca85dc9ac5a0b99274a5c45f111f2eec1c/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/c48b03ca85dc9ac5a0b99274a5c45f111f2eec1c/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/c48b03ca85dc9ac5a0b99274a5c45f111f2eec1c/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/c48b03ca85dc9ac5a0b99274a5c45f111f2eec1c/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"DECK","IsMainListingImage":false,"Caption":"DECK","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/76670d2d1d2fcf5ca92e924d7341c20dd14d71b8/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/76670d2d1d2fcf5ca92e924d7341c20dd14d71b8/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/76670d2d1d2fcf5ca92e924d7341c20dd14d71b8/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/76670d2d1d2fcf5ca92e924d7341c20dd14d71b8/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/76670d2d1d2fcf5ca92e924d7341c20dd14d71b8/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"VIEW OF LAKE","IsMainListingImage":false,"Caption":"VIEW OF LAKE","Description":"","Width":3456,"Height":2304,"MimeType":"image/jpeg"},{"FullURL":"http://foo.bar/img-np/i/3d9451a6cc97da111a4b5236222f01029bd19a3e/0_2_full.jpg","GalleryURL":"http://foo.bar/img-np/i/3d9451a6cc97da111a4b5236222f01029bd19a3e/0_2_gallery.jpg","RawURL":"http://foo.bar/img-np/i/3d9451a6cc97da111a4b5236222f01029bd19a3e/0_2_raw.jpg","SmallURL":"http://foo.bar/img-np/i/3d9451a6cc97da111a4b5236222f01029bd19a3e/0_2_small.jpg","ThumbURL":"http://foo.bar/img-np/i/3d9451a6cc97da111a4b5236222f01029bd19a3e/0_2_thumb.jpg","EmbededHTMLContent":"","Title":"VIEW OF LAKE","IsMainListingImage":false,"Caption":"VIEW OF LAKE","Description":"","Width":400,"Height":300,"MimeType":"image/jpeg"}]}]}'))
          it 'should return a MoxiworksPlatform::Gallery Object when find is called' do
            VCR.use_cassette('gallery/find/success', record: :none) do
              attrs = {'moxi_works_agent_id': moxi_works_agent_id, 'moxi_works_company_id': moxi_works_company_id}
              out = MoxiworksPlatform::Gallery.find(symbolize_keys(attrs))
              expect(out['galleries'].first.class).to eq(MoxiworksPlatform::Gallery)
            end
          end

          accessors.each do |attr_accessor|
            it "should have populated attribute #{attr_accessor} when update with all attributes populated" do
              VCR.use_cassette('gallery/find/success', record: :none) do
                attrs = {'moxi_works_agent_id': moxi_works_agent_id, 'moxi_works_company_id': moxi_works_company_id}
                out = MoxiworksPlatform::Gallery.find(symbolize_keys(attrs))
                expect(out['galleries'].first.send(attr_accessor.to_s)).to eq(full_response['galleries'].first[attr_accessor.to_s])
              end
            end
          end
        end
      end
    end
  end

end
